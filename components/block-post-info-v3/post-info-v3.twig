{# Do not edit this file outside of the component library as your changes will be lost with future updates. #}
{% set blockClassName = "post-info-v3" %}
{% set classNameEntryPoint = include('entry-points/entry-point-classes.twig', { fields, block }, with_context = false) %}
{% set htmlEntryPoint = include('entry-points/entry-point-html-v3.twig', { fields, block, blockClassName, options, environment, is_preview, cta_styles, nav_menus }, with_context = false) %}
{% set dataAttributeEntryPoint = include('entry-points/entry-point-data-attribute.twig', { fields, block }, with_context = false) %}
{% set styleEntryPoint = include('entry-points/entry-point-style-v3.twig', { fields, block, displaytype, is_preview }, with_context = false) %}
{% set previewEntryPoint = include('entry-points/entry-point-preview-info.twig', { fields, block, displaytype, is_preview }, with_context = false) %}

{% set layoutType = fields.layout_type|ru|default('grid') %}
{% set layoutStyles = '' %}
{% if layoutType == 'flex' %}
	{% set layoutStyles = include('components/flex-layout-container-v3.twig', { fields, block }, with_context = false) %}
	{% set layoutClass = 'flex-layout-container' %}
{% elseif layoutType == 'grid' %}
	{% set layoutStyles = include('components/grid-layout-container-v3.twig', { fields, block }, with_context = false) %}
	{% set layoutClass = 'grid-layout-container' %}
{% endif %}

{% if fields.grid_layout.grid_template_rows_custom_desktop == 'subgrid' %}
	{% set layoutClass = layoutClass ~ ' subgrid-layout-desktop ' %}
{% endif %}
{% if fields.grid_layout.grid_template_rows_custom_portrait == 'subgrid' %}
	{% set layoutClass = layoutClass ~ ' subgrid-layout-portrait ' %}
{% endif %}
{% if fields.grid_layout.grid_template_rows_custom_mobile == 'subgrid' %}
	{% set layoutClass = layoutClass ~ ' subgrid-layout-mobile ' %}
{% endif %}

{% set sectionStyles =  styleEntryPoint ~ gridGapMults ~ layoutStyles %}
{% if fields.post_info_type|ru == 'post-info' %}
	{% set post = get_post(fields.post) %}
{% endif %}
{% if fields.post_info_type|ru == 'post-taxonomy' %}
	{% set post = get_term(fields.taxonomy) %}
{% endif %}

{% set postTypeFields = fields.post_fields %}
{% set layout = fields.layout|ru %}
{% set imageSizes = imageSizes %}

{{previewEntryPoint}}

<style>
	.{{blockClassName}}.{{block.id}}{
		{{sectionStyles}}
	}
</style>

<section {{block.anchor ? "id=" ~ block.anchor : ''}} class="{{blockClassName}} {{layoutClass}} {{block.className}} {{loop > 0 and block.className ? block.className ~ '-' ~ loop : ''}} {{classNameEntryPoint}} {{block.className}} lazy-fade {{block.id}}" {{dataAttributeEntryPoint}} data-assetkey="post-info-v3" data-post-info-type={{fields.post_info_type}}>

	{% for field in postTypeFields %}
		{% if block %}
			{% set block = block|merge({'anchor' : '','className' : '', 'id': block.id ~ '-' ~ loop.index }) %}
		{% endif %}
		{% if field.acf_fc_layout == 'cta_selection' or field.acf_fc_layout == 'social_media_share' %}
			{{include('components/' ~ field.acf_fc_layout|replace({'_': '-'}) ~ '.twig', {fields: field, field, post, block, blockClassName, postType, options, cta_styles, imageSizes}, with_context = false, ignore_missing = true)}}
		{% else %}
			{{include('blocks/post-info-v3/' ~ field.acf_fc_layout|replace({'_': '-'}) ~ '.twig', {field, post, block, blockClassName, postType, options, cta_styles, imageSizes}, with_context = false, ignore_missing = true)}}
		{% endif %}
	{% endfor %}
	{% if fields.enable_post_cover_link %}
		{% set coverlinkHover = fields.enable_post_cover_link_hover_effect ? 'post-cover-link-hover-effect' : '' %}
		<a data-pattern-post-info="link" href="{{ post.link }}" target="_self" class="{{blockClassName}}__post-cover-link {{coverlinkHover}}" aria-label="{{post.title}}">
			<span class="{{blockClassName}}__post-cover-label">{{post.title}}</span>
		</a>
	{% endif %}
	{{htmlEntryPoint}}
</section>
