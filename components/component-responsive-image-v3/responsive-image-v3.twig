{# Do not edit this file outside of the component library as your changes will be lost with future updates. #}
{% if fields.enable_image|default(fields.image_enabled) %}
	{% set renderDynamic = fields.child_patterns.render_dynamic|default(0) %}
	{% set suffix = fields.child_patterns.suffix %}
	{% set desktopType = fields.desktop_image_aspect_ratio|ru|default('original') %}
	{% set tabletType = fields.tablet_image_aspect_ratio|ru|default('original') %}
	{% set mobileType = fields.mobile_image_aspect_ratio|ru|default('original') %}

	{% set desktopPath = desktopType == 'original' or desktopType == 'custom_aspect_ratio' ? 'desktop_image' : 'desktop_image_' ~ desktopType %}
	{% set tabletPath = tabletType == 'original' or tabletType == 'custom_aspect_ratio' ? 'tablet_image' : 'tablet_image_' ~ tabletType %}
	{% set mobilePath = mobileType == 'original' or mobileType == 'custom_aspect_ratio' ? 'mobile_image' : 'mobile_image_' ~ mobileType %}
	{% set desktopImage = get_image(fields[desktopPath]) %}
	{% set tabletImage = get_image(fields[tabletPath])|default(desktopImage) %}
	{% set mobileImage = get_image(fields[mobilePath]) %}

	{% set imageSizes = fields.custom_image_sizes %}
	{% set sizes = imageSizes|default('(min-width: 1440px) 100vw, (min-width: 1024px) 1024px, (min-width: 768px) 768px, (min-width: 500px) 100vw, 250px') %}
	{% set imageFitStyle = '--image-fit-style:' ~ (fields.image_fit_style|ru|default('cover')) ~ ';' %}
	{% set imageObjectPositionAlign = '--image-object-position-align:' ~ (fields.image_object_position_align|ru) ~ ';' %}
	{% set imageWidth = '--image-width:' ~ fields.image_width|default(100) ~ '%;' %}
	{% set imageWidthMobile = '--image-width-mobile:' ~ fields.image_width_mobile|default(100) ~ '%;' %}
	{% set imageWidthPortrait = '--image-width-portrait:' ~ fields.image_width_portrait|default(100) ~ '%;' %}
	{% set imageOpacity = '--image-opacity:' ~ fields.image_opacity|default(1) ~ ';' %}
	{% set imageZIndex = '--image-z-index:' ~ fields.image_z_index|default(0) ~ ';' %}
	{% set imagePosition = '--image-position:' ~ fields.image_position|ru ~ ';' %}
	{% set imageGridArea = '--image-grid-area:' ~ fields.image_grid_area|ru|default('main') ~ ';' %}
	{% set imageBorderRadius = '--image-border-radius:' ~ fields.image_border_radius ~ ';' %}
	{% set imageAspectRatioDesktop = '--image-aspect-ratio-desktop:' ~ fields.image_aspect_ratio_desktop ~ ';' %}
	{% set imageAspectRatioPortrait = '--image-aspect-ratio-portrait:' ~ fields.image_aspect_ratio_portrait ~ ';' %}
	{% set imageAspectRatioMobile = '--image-aspect-ratio-mobile:' ~ fields.image_aspect_ratio_mobile ~ ';' %}
	{% set imageOffsetVert = '--image-offset-vert:' ~ fields.image_offset_vertical ~ '%;' %}
	{% set imageOffsetHoriz = '--image-offset-horiz:' ~ fields.image_offset_horizontal ~ '%;' %}
	{% set enableImageBorder = fields.enable_image_border %}
	{% if enableImageBorder %}
		{% set imageBorderColour = '--image-border-colour:' ~ (fields.image_border_colour|ru|default(000)) ~ ';' %}
		{% set imageBorderWidth = '--image-border-width:' ~ (fields.image_border_width|ru|default(1)) ~ ';' %}
		{% set imageBorderStyle = '--image-border-style:' ~ (fields.image_border_style|ru|default('solid')) ~ ';' %}
	{% endif %}
	{% set imageMinHeightMobile = '--image-min-height-mobile:' ~ (fields.image_min_height_mobile|ru|default('auto')) ~ ';' %}
	{% set imageMinHeightDesktop = '--image-min-height-desktop:' ~ (fields.image_min_height_desktop|ru|default('auto')) ~ ';' %}
	{% set subtractHeaderHeight = '--cancel-header-height:' ~ (fields.subtract_header_height ? '0px' : 'var(--global-site-header-height, 0px)') ~ ';' %}
	{% set imageBorderString = imageBorderColour ~ imageBorderWidth ~ imageBorderStyle %}
	{% set pictureStylesString = imageFitStyle ~ imageObjectPositionAlign ~ imageWidth ~ imageWidthMobile ~ imageWidthPortrait ~ imageOpacity ~ imageAspectRatioDesktop ~ imageAspectRatioPortrait ~ imageAspectRatioMobile ~ imageOffsetVert ~ imageOffsetHoriz ~ imageBorderRadius ~ imagePosition ~ imageGridArea ~ imageMinHeightMobile ~ imageMinHeightDesktop ~ subtractHeaderHeight ~ imageZIndex %}
	{% set enableEagerLoading = fields.enable_eager_image_loading ? '' : 'loading="lazy"' %}

	{% set selectedAspectRatioDesktop = fields.desktop_image_aspect_ratio|ru %}
	{% set selectedAspectRatioTablet = fields.tablet_image_aspect_ratio|ru %}
	{% set selectedAspectRatioMobile = fields.mobile_image_aspect_ratio|ru %}

	{% if selectedAspectRatioDesktop == 'original' %}
		{% set isSVG = desktopImage.post_mime_type == 'image/svg+xml' %}
		{% set selectedAspectRatioDesktop = null %}
		{% set mainImageSrc = isSVG ? desktopImage.src : gt_image_mainsrc(desktopImage) %}
		{% set desktopSrcset = isSVG ? desktopImage.src : gt_image_srcset(desktopImage) %}
	{% elseif selectedAspectRatioDesktop == 'custom_aspect_ratio' %}
		{% set isSVG = desktopImage.post_mime_type == 'image/svg+xml' %}
		{% set customAspectRatio = fields.desktop_custom_aspect_ratio %}
		{% set mainImageSrc = isSVG ? desktopImage.src : gt_image_mainsrc(desktopImage, {"aspect_ratio": customAspectRatio|replace({'/' : 'x', ':' : 'x'})}) %}
		{% set desktopSrcset = isSVG ? desktopImage.src : gt_image_srcset(desktopImage, {"aspect_ratio": customAspectRatio|replace({'/' : 'x', ':' : 'x'})}) %}
	{% else %}
		{% set isSVG = desktopImage.post_mime_type == 'image/svg+xml' %}
		{% set mainImageSrc = isSVG ? desktopImage.src : gt_image_mainsrc(desktopImage, {"aspect_ratio" : selectedAspectRatioDesktop}) %}
		{% set desktopSrcset = isSVG ? desktopImage.src : gt_image_srcset(desktopImage, {"aspect_ratio" : selectedAspectRatioDesktop}) %}
	{% endif %}

	{% if selectedAspectRatioTablet == 'original' %}
		{% set isSVG = tabletImage.post_mime_type == 'image/svg+xml' %}
		{% set selectedAspectRatioTablet = null %}
		{% set tabletSrcset =  isSVG ? tabletImage.src : gt_image_srcset(tabletImage)%}
	{% elseif selectedAspectRatioTablet == 'custom_aspect_ratio' %}
		{% set isSVG = tabletImage.post_mime_type == 'image/svg+xml' %}
		{% set customAspectRatio = fields.tablet_custom_aspect_ratio %}
		{% set mainImageSrc = isSVG ? tabletImage.src : gt_image_mainsrc(tabletImage, {"aspect_ratio": customAspectRatio|replace({'/' : 'x', ':' : 'x'})}) %}
		{% set tabletSrcset = isSVG ? tabletImage.src : gt_image_srcset(tabletImage, {"aspect_ratio": customAspectRatio|replace({'/' : 'x', ':' : 'x'})}) %}
	{% else %}
		{% set isSVG = tabletImage.post_mime_type == 'image/svg+xml' %}
		{% set tabletSrcset =  isSVG ? tabletImage.src : gt_image_srcset(tabletImage, {"aspect_ratio" : selectedAspectRatioTablet})%}
	{% endif %}

	{% if selectedAspectRatioMobile == 'original' %}
		{% set isSVG = mobileImage.post_mime_type == 'image/svg+xml' %}
		{% set selectedAspectRatioMobile = null %}
		{% set mobileSrcset =  isSVG ? mobileImage.src : gt_image_srcset(mobileImage) %}
	{% elseif selectedAspectRatioMobile == 'custom_aspect_ratio' %}
		{% set isSVG = mobileImage.post_mime_type == 'image/svg+xml' %}
		{% set customAspectRatio = fields.mobile_custom_aspect_ratio %}
		{% set mainImageSrc = isSVG ? mobileImage.src : gt_image_mainsrc(mobileImage, {"aspect_ratio": customAspectRatio|replace({'/' : 'x', ':' : 'x'})}) %}
		{% set mobileSrcset = isSVG ? mobileImage.src : gt_image_srcset(mobileImage, {"aspect_ratio": customAspectRatio|replace({'/' : 'x', ':' : 'x'})}) %}
	{% else %}
		{% set isSVG = mobileImage.post_mime_type == 'image/svg+xml' %}
		{% set mobileSrcset =  isSVG ? mobileImage.src : gt_image_srcset(mobileImage, {"aspect_ratio" : selectedAspectRatioMobile})%}
	{% endif %}
	{% set parallaxEnabled = fields.parallax_enabled %}
	{% if parallaxEnabled %}
		{% set parallaxDepth = 'data-depth=' ~ fields.parallax_depth ~ " " %}
		{% set parallaxOffsetY = 'data-y-offset=' ~ fields.parallax_offset_y ~ " " %}
	{% endif %}

	<style>
		.{{blockClassName|default('cbl-image')}}__picture.{{block.id}}{
			{{pictureStylesString}}
			{{imageBorderString}}
			{% if selectedAspectRatioDesktop == 'custom_aspect_ratio' %}
				--image-aspect-ratio-desktop: {{fields.desktop_custom_aspect_ratio}}
				;
			{% elseif selectedAspectRatioDesktop %}
				--image-aspect-ratio-desktop: {{selectedAspectRatioDesktop|replace({'x': '/'})}}
				;
			{% endif %}

			{% if selectedAspectRatioTablet == 'custom_aspect_ratio' %}
				--image-aspect-ratio-portrait: {{fields.tablet_custom_aspect_ratio}}
				;
			{% elseif selectedAspectRatioTablet %}
				--image-aspect-ratio-portrait: {{selectedAspectRatioTablet|replace({'x': '/'})}}
				;
			{% endif %}

			{% if selectedAspectRatioMobile == 'custom_aspect_ratio' %}
				--image-aspect-ratio-mobile: {{fields.mobile_custom_aspect_ratio}}
				;
			{% elseif selectedAspectRatioMobile %}
				--image-aspect-ratio-mobile: {{selectedAspectRatioMobile|replace({'x': '/'})}}
				;
			{% endif %}
		}
	</style>
	<picture class="{{ blockClassName|default('cbl-image') }}__picture {{block.id}}" data-pattern-suffix="{{suffix}}" data-pattern-dynamic="{{renderDynamic}}" data-assetkey="responsive-image" data-enableparallax="{{ parallaxEnabled }}">
		{% if desktopImage %}
			<source data-type="srcSetDesktop" data-pattern-suffix="{{suffix}}" media="(min-width: 1024px)" class="{{ blockClassName|default('cbl-image') }}__source {{ blockClassName|default('cbl-image') }}--desktop" width="{{ desktopImage.width }}" height="{{ desktopImage.height }}" sizes="{{ sizes }}" srcset="{{desktopSrcset}}"/>
		{% endif %}
		{% if tabletImage %}
			<source data-type="srcSetTablet" data-pattern-suffix="{{suffix}}" media="(min-width: 768px)" width="{{ tabletImage.width }}" height="{{ tabletImage.height }}" class="{{ blockClassName|default('cbl-image') }}__source {{ blockClassName|default('cbl-image') }}--tablet" sizes="{{ sizes }}" srcset="{{ tabletSrcset }}"/>
		{% endif %}
		{% if mobileImage %}
			<source data-type="srcSetMobile" data-pattern-suffix="{{suffix}}" class="{{ blockClassName|default('cbl-image') }}__source {{ blockClassName|default('cbl-image') }}__source--mobile" width="{{ mobileImage.width }}" height="{{ mobileImage.height }}" sizes="{{ sizes }}" srcset="{{ mobileSrcset }}"/>
		{% endif %}
		<img data-type="srcGeneral" data-elementname="main-image" data-pattern-suffix="{{suffix}}" data-pattern-dynamic="{{renderDynamic}}" {{ enableEagerLoading }} class="{{ blockClassName|default('cbl-image') }}__image" src="{{mainImageSrc}}" alt="{{ desktopImage.alt }}" {{ parallaxDepth }} {{ parallaxOffsetY }}/>
	</picture>
{% endif %}
