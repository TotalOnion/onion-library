{# Do not edit this file outside of the component library as your changes will be lost with future updates. #}
{% set blockClassName = "carousel-multi-layout-v3" %}
{% set classNameEntryPoint = include('entry-points/entry-point-classes.twig', { fields, block }, with_context = false) %}
{% set htmlEntryPoint = include('entry-points/entry-point-html-v3.twig', { fields, block, blockClassName, options, environment, is_preview, nav_menus }, with_context = false) %}
{% set dataAttributeEntryPoint = include('entry-points/entry-point-data-attribute.twig', { fields, block }, with_context = false) %}
{% set styleEntryPoint = include('entry-points/entry-point-style.twig', { fields, block, displaytype, is_preview }, with_context = false) %}
{% set previewEntryPoint = include('entry-points/entry-point-preview-info.twig', { fields, block, displaytype, is_preview }, with_context = false) %}


{% set blockOverflow = '--block-overflow:' ~ fields.block_overflow|ru ~ ';' %}

{% set arrowColour = '--swiper-arrow-colour:' ~ fields.carousel_nav_arrow_colour|ru ~ ';' %}
{% set paginationColour = '--swiper-pagination-colour:' ~ fields.carousel_pagination_colour|ru ~ ';' %}
{% set carouselBackgroundColour = '--carousel-bg-colour:' ~ fields.background_colour|default(fields.carousel_background_colour) ~ ';' %}

{% set customArrowImageLeft = get_image(fields.custom_arrow_image_left) %}
{% set customArrowImageRight = get_image(fields.custom_arrow_image_right) %}
{% set customArrowsSizeDesktop = '--custom-arrows-size-desktop: ' ~ fields.custom_arrows_size_desktop ~ ';' %}
{% set customArrowsSizePortrait = '--custom-arrows-size-portrait:' ~ fields.custom_arrows_size_portrait ~ ';' %}
{% set customArrowsSizeMobile = '--custom-arrows-size-mobile:' ~ fields.custom_arrows_size_mobile ~ ';' %}

{% if fields.show_advanced_offset_controls == true %}
	{% set carousel_slides_offset_before_desktop = fields.advanced_slide_offset.slides_offset_before_desktop %}
	{% set carousel_slides_offset_before_tablet = fields.advanced_slide_offset.slides_offset_before_tablet %}
	{% set carousel_slides_offset_before_mobile = fields.advanced_slide_offset.slides_offset_before_mobile %}
	{% set carousel_slides_offset_after_desktop = fields.advanced_slide_offset.slides_offset_after_desktop %}
	{% set carousel_slides_offset_after_tablet = fields.advanced_slide_offset.slides_offset_after_tablet %}
	{% set carousel_slides_offset_after_mobile = fields.advanced_slide_offset.slides_offset_after_mobile %}
{% else %}
	{% set carousel_slides_offset_before_desktop = fields.carousel_slides_offset_desktop %}
	{% set carousel_slides_offset_before_tablet = fields.carousel_slides_offset_tablet %}
	{% set carousel_slides_offset_before_mobile = fields.carousel_slides_offset_mobile %}
	{% set carousel_slides_offset_after_desktop = fields.carousel_slides_offset_desktop %}
	{% set carousel_slides_offset_after_tablet = fields.carousel_slides_offset_tablet %}
	{% set carousel_slides_offset_after_mobile = fields.carousel_slides_offset_mobile %}
{% endif %}

{% set nextPrevSlideOpacityDesktop = '--next-and-prev-slide-opacity-desktop:' ~ fields.next_and_prev_slide_opacity_desktop ~ ';' %}
{% set nextPrevSlideOpacityPortrait = '--next-and-prev-slide-opacity-portrait:' ~ fields.next_and_prev_slide_opacity_portrait ~ ';' %}
{% set nextPrevSlideOpacityMobile = '--next-and-prev-slide-opacity-mobile:' ~ fields.next_and_prev_slide_opacity_mobile ~ ';' %}
{% set arrowsPosVertDesktop = '--arrows-position-vertically-desktop: ' ~ fields.arrows_position_vertically_desktop ~ '%;' %}
{% set leftArrowHorizDesktop = '--left-arrow-horizontally-desktop: ' ~ fields.left_arrow_horizontally_desktop ~ '%;' %}
{% set rightArrowHorizDesktop = '--right-arrow-horizontally-desktop: ' ~ fields.right_arrow_horizontally_desktop ~ '%;' %}
{% set arrowsPosVertPortrait = '--arrows-position-vertically-portrait: ' ~ fields.arrows_position_vertically_portrait ~ '%;' %}
{% set leftArrowHorizPortrait = '--left-arrow-horizontally-portrait: ' ~ fields.left_arrow_horizontally_portrait ~ '%;' %}
{% set rightArrowHorizPortrait = '--right-arrow-horizontally-portrait: ' ~ fields.right_arrow_horizontally_portrait ~ '%;' %}
{% set arrowsPosVertMobile = '--arrows-position-vertically-mobile: ' ~ fields.arrows_position_vertically_mobile ~ '%;' %}
{% set leftArrowHorizMobile = '--left-arrow-horizontally-mobile: ' ~ fields.left_arrow_horizontally_mobile ~ '%;' %}
{% set rightArrowHorizMobile = '--right-arrow-horizontally-mobile: ' ~ fields.right_arrow_horizontally_mobile ~ '%;' %}
{% set paginationPosOffsetDesktop = '--pagination-position-offset-desktop: ' ~ fields.pagination_position_offset_desktop ~ '%;' %}
{% set paginationPosOffsetPortrait = '--pagination-position-offset-portrait: ' ~ fields.pagination_position_offset_portrait ~ '%;' %}
{% set paginationPosOffsetMobile = '--pagination-position-offset-mobile: ' ~ fields.pagination_position_offset_mobile ~ '%;' %}
{% set arrowsSizeDesktop = '--arrows-size-desktop: ' ~ fields.arrows_size_desktop ~ ';' %}
{% set arrowsSizePortrait = '--arrows-size-portrait:' ~ fields.arrows_size_portrait ~ ';' %}
{% set arrowsSizeMobile = '--arrows-size-mobile:' ~ fields.arrows_size_mobile ~ ';' %}

{% set display = 'flex' %}
{% set showArrowsDesktop = '--display-arrows-desktop:' ~ display ~ ';' %}
{% set showArrowsPortrait = '--display-arrows-portrait:' ~ display ~ ';' %}
{% set showArrowsMobile = '--display-arrows-mobile:' ~ display ~ ';' %}
{% if fields.button_visibility %}
	{% set showOnDesktop = '--display-arrows-desktop: ' ~ (fields.button_visibility.desktop ? 'display' : 'none') ~ ';' %}
	{% set showOnPortrait = '--display-arrows-portrait: ' ~ (fields.button_visibility.portrait ? 'display' : 'none') ~ ';' %}
	{% set showOnMobile = '--display-arrows-mobile: ' ~ (fields.button_visibility.mobile  ? 'display' : 'none') ~  ';' %}
{% endif %}

{% set paginationColor = '--swiper-pagination-color:' ~ fields.carousel_pagination_colour|ru ~ ';' %}
{% set paginationInactiveColour = '--swiper-pagination-bullet-inactive-color:' ~ fields.carousel_pagination_inactive_colour|ru ~ ';' %}
{% set paginationActiveBulletOpacity = '--swiper-pagination-bullet-opacity:' ~ fields.carousel_pagination_active_bullet_opacity|ru ~ ';' %}
{% set paginationInactiveBulletOpacity = '--swiper-pagination-bullet-inactive-opacity:' ~ fields.carousel_pagination_inactive_bullet_opacity|ru ~ ';' %}
{% set paginationBulletWidth = '--swiper-pagination-bullet-width:' ~ fields.carousel_pagination_bullet_width|ru ~ 'px;' %}
{% set paginationBulletHeight = '--swiper-pagination-bullet-height:' ~ fields.carousel_pagination_bullet_height|ru ~ 'px;' %}
{% set paginationBulletHorizontalGap = '--swiper-pagination-bullet-horizontal-gap:' ~ fields.carousel_pagination_bullet_horizontal_gap|ru ~ 'px;' %}

{% set carouselPaginationStyle = fields.carousel_pagination_style|default('bullets')|ru %}
{% set fractionStyle = 'data-fractionstyle="' ~ fields.fraction_style|ru ~ '"' %}
{% set fractionString = 'data-fractionstring="' ~ fields.fraction_text|ru ~ '"' %}

{% set sectionStyles =  styleEntryPoint ~ blockBorderRadius ~ blockOverflow ~ arrowColour ~ paginationColour ~ paginationInactiveColour ~ paginationActiveBulletOpacity ~ paginationInactiveBulletOpacity ~ paginationBulletWidth ~ paginationBulletHeight ~ paginationBulletHorizontalGap ~ arrowColour ~ paginationColor ~ carouselBackgroundColour ~ nextPrevSlideOpacityDesktop ~ nextPrevSlideOpacityPortrait ~ nextPrevSlideOpacityMobile ~ arrowsPosVertDesktop ~ leftArrowHorizDesktop ~ rightArrowHorizDesktop ~ arrowsPosVertPortrait ~ leftArrowHorizPortrait ~ rightArrowHorizPortrait ~ arrowsPosVertMobile ~ leftArrowHorizMobile ~ rightArrowHorizMobile ~ paginationPosOffsetDesktop ~ paginationPosOffsetPortrait ~ paginationPosOffsetMobile ~ arrowsSizeDesktop ~ arrowsSizePortrait ~ arrowsSizeMobile ~ customArrowsSizeDesktop ~ customArrowsSizePortrait ~ customArrowsSizeMobile ~ showOnDesktop ~ showOnPortrait ~ showOnMobile %}

{% set centerInsufficientSlidesDesktop = 'data-centerinsufficientslidesdesktop="'  ~ fields.center_insufficient_slides_desktop ~ '"' %}
{% set centerInsufficientSlidesPortrait = 'data-centerinsufficientslidesportrait="' ~ fields.center_insufficient_slides_portrait ~ '"' %}
{% set centerInsufficientSlidesMobile = 'data-centerinsufficientslidesmobile="' ~ fields.center_insufficient_slides_mobile ~ '"' %}

{% set autoplay = 'data-autoplay="' ~ fields.carousel_autoslide ~ '"' %}
{% set freeMode = 'data-enablefreemode="' ~ fields.enable_freemode ~ '"' %}
{% set mouseWheel = 'data-enablemousewheel="' ~ fields.enable_mousewheel ~ '"' %}
{% set transitionDelay = 'data-transitiondelay="' ~ fields.carousel_transition_delay ~ '"' %}
{% set transitionSpeed = 'data-transitionspeed="' ~ fields.carousel_transition_speed ~ '"' %}
{% set transitionStyle = 'data-transitionstyle="' ~ fields.carousel_transition_style|ru ~ '"' %}

{% set mobileSlides = 'data-mobileslides="' ~ fields.carousel_number_of_slides_mobile ~ '"' %}
{% set tabletSlides = 'data-tabletslides="' ~ fields.carousel_number_of_slides_tablet ~ '"' %}
{% set desktopSlides = 'data-desktopslides="' ~ fields.carousel_number_of_slides_desktop ~ '"' %}

{% set imageSizes = '(min-width: 1440px) ' ~ (100 / fields.carousel_number_of_slides_desktop|default(1))|round ~ 'vw, (min-width: 1024px) ' ~ (100 / fields.carousel_number_of_slides_desktop|default(1))|round ~ 'vw, (min-width: 768px) ' ~ (100 / fields.carousel_number_of_slides_tablet|default(1))|round ~ 'vw, (min-width: 300px) ' ~(100 / fields.carousel_number_of_slides_mobile|default(1))|round ~ 'vw, 100vw' %}


{% set sectionDataAttributes = dataAttributeEntryPoint ~ centerInsufficientSlidesDesktop ~ centerInsufficientSlidesPortrait ~ centerInsufficientSlidesMobile ~ autoplay ~ freeMode ~ mouseWheel ~ transitionDelay ~ transitionSpeed ~ transitionStyle ~ fractionStyle ~ fractionString ~ mobileSlides ~ tabletSlides ~ desktopSlides %}

{{previewEntryPoint}}
<style>
	.{{blockClassName}}.{{block.id}}{
		{{sectionStyles}}
	}
</style>
<section {{block.anchor ? "id=" ~ block.anchor : ''}} class="{{ blockClassName }} lazy-fade {{block.id}} {{block.className}} {{classNameEntryPoint}} {{loop ? block.className.index ~ '-' ~ loop.index : ''}} " {{sectionDataAttributes}} data-mobileslidesoffsetbefore="{{carousel_slides_offset_before_mobile}}" data-mobileslidesoffsetafter="{{carousel_slides_offset_after_mobile}}" data-tabletslidesoffsetbefore="{{carousel_slides_offset_before_tablet}}" data-tabletslidesoffsetafter="{{carousel_slides_offset_after_tablet}}" data-desktopslidesoffsetbefore="{{carousel_slides_offset_before_desktop}}" data-desktopslidesoffsetafter="{{carousel_slides_offset_after_desktop}}" data-desktopspacebetweenslides="{{fields.carousel_space_between_slides_desktop}}" data-mobilespacebetweenslides="{{fields.carousel_space_between_slides_mobile}}" data-tabletspacebetweenslides="{{fields.carousel_space_between_slides_tablet}}" data-centeractiveslide="{{fields.carousel_center_active_slide}}" data-centeractiveslideportrait="{{fields.center_active_slide_portrait}}" data-centeractiveslidemobile="{{fields.center_active_slide_mobile}}" data-loopslides="{{fields.loop_slides}}" data-loopslidesportrait="{{fields.loop_slides_portrait}}" data-loopslidesmobile="{{fields.loop_slides_mobile}}" data-paginationstyle="{{carouselPaginationStyle}}" data-assetkey="{{ blockClassName }}">

	{% set arrowData = fields %}
	<div class="{{ blockClassName }}__inner-container">
		<div class="swiper {{ blockClassName }}__swiper-carousel-container">
			<div class="swiper-wrapper" data-pattern-repeater-parent="1">
				{% for slide in fields.slides %}
					{% if block %}
						{% set block = block|merge({'anchor' : '','className' : '', 'id': block.id ~ loop.index }) %}
					{% endif %}
					<div class="swiper-slide {{ blockClassName }}__slide" data-pattern-repeater-child="1">
						{{ include("blocks/" ~ slide.acf_fc_layout|replace({"_" : "-"}) ~ ".twig", {fields: slide, block, options, nav_menus, cta_styles, market_slug, imageSizes }, with_context = false, ignore_missing = true) }}
					</div>
				{% endfor %}
			</div>
		</div>
		{% set positionVars = include('components/element-positioning-v3.twig', { fields, block, blockClassName, is_preview}, with_context = false) %}

		{% if fields.carousel_pagination %}
			<div class="swiper-pagination" style="{{positionVars}}"></div>
		{% endif %}
		{% if fields.enable_carousel_nav_arrows and fields.enable_custom_arrows == false %}
			<div class="{{ blockClassName }}__button-prev swiper-button-prev"></div>
			<div class="{{ blockClassName }}__button-next swiper-button-next"></div>
		{% elseif fields.enable_carousel_nav_arrows and fields.enable_custom_arrows %}
			<img class="swiper-button-prev custom_arrow" src="{{customArrowImageLeft.src}}" alt="{{customArrowImageLeft.alt}}">
			<img class="swiper-button-next custom_arrow" src="{{customArrowImageRight.src}}" alt="{{customArrowImageRight.alt}}">
		{% endif %}
	</div>
</section>
